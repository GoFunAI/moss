import{w as ie,k as C,x as se,y as re,z as ue,A as ce,f as de,u as me,B as pe,C as _e,D as ve,E as ge,F as Q}from"./index.ad236f72.js";import{u as R,a as xe}from"./vue-request.068b6d0d.js";import{j as n,k as l,p as g,v as t,m as e,F as $,Q as X,l as f,$ as a,y as v,z as c,n as L,i as Z,u as fe,s as te,r as w,c as le,V as ye,a2 as be,B as Y,O as ke,az as Ce}from"./@vue.1832462a.js";import{M as F}from"./@arco-design.fc217e7a.js";import{f as ee}from"./naive-ui.4ada00fb.js";import{e as he}from"./@vueuse.b7caaad8.js";import"./vue-router.d0ac2f3e.js";import"./vue-i18n.32b246c6.js";import"./@intlify.bed9fa1a.js";import"./source-map.205bdfab.js";import"./vue.307b73bb.js";import"./pinia.3d582541.js";import"./vue-demi.b3a9cad9.js";import"./axios.7d4390ff.js";import"./form-data.2b153385.js";/* empty css                    */import"./resize-observer-polyfill.8deb1e21.js";import"./compute-scroll-into-view.17358474.js";import"./b-tween.87ffe365.js";import"./dayjs.396bdce9.js";import"./b-validate.ee581f7d.js";import"./number-precision.6dad9ff9.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./date-fns.a06005bd.js";import"./seemly.d0f7d7a4.js";import"./evtd.9eee5233.js";import"./@css-render.fee374bc.js";import"./css-render.20ab466e.js";import"./@emotion.6322e2ae.js";import"./vooks.186fd3b0.js";import"./vueuc.533174bc.js";import"./vdirs.ab69c576.js";import"./@juggle.32c34d6c.js";import"./lodash-es.33d1f95f.js";import"./date-fns-tz.c3c7eb03.js";const we=L("span",{class:"text-xs"},"\u66F4\u591A\u8BBE\u7F6E\u65B9\u6CD5,\u53C2\u8003cron\u8868\u8FBE\u5F0F,\u6CE8\u610F: cron\u8868\u8FBE\u5F0F\u53EA\u652F\u63016\u4F4D(\u4E0D\u652F\u6301\u5E74)",-1),Ie={__name:"CronExpExample",setup(d){const E=[{explain:"\u6BCF30\u79D2",example:["@every 30s","0/30 * * * * ? "]},{explain:"\u6BCF5\u5206\u949F",example:["@every 5m"]},{explain:"\u6BCF1\u4E2A\u534A\u5C0F\u65F6",example:["@every 1h30m"]},{explain:"\u6BCF\u5C0F\u65F6",example:["@hourly"]},{explain:"\u6BCF\u5929",example:["@daily","@midnight"]},{explain:"\u6BCF\u59293:15\u5206",example:["0 15 3 * * ?"]},{explain:"\u6BCF\u5468",example:["@weekly"]},{explain:"\u6BCF\u5468\u4E8C 0:30\u5206",example:["0 30 0 * * 2"]},{explain:"\u6BCF\u5468\u56DB\u4E0A\u53487\u70B9",example:[" 0 0 7 ? * 4"]},{explain:"\u6BCF\u6708",example:["@monthly"]},{explain:"\u6BCF\u5E74",example:["@yearly","@annually"]}];return(D,x)=>{const b=n("a-tag"),h=n("a-space"),y=n("a-descriptions-item"),z=n("a-descriptions"),m=n("a-alert");return l(),g($,null,[t(z,{bordered:"",column:1},{default:e(()=>[(l(),g($,null,X(E,i=>t(y,{label:i.explain},{default:e(()=>[t(h,null,{default:e(()=>[(l(!0),g($,null,X(i.example,O=>(l(),f(b,{class:"cursor-pointer",onClick:a(ie)},{default:e(()=>[v(c(O),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024)]),_:2},1032,["label"])),64))]),_:1}),t(m,{banner:"",class:"mt-5"},{default:e(()=>[we]),_:1})],64)}}},$e=[{title:"ID",dataIndex:"id",slotName:"id",width:240,ellipsis:!0},{slotName:"action",width:170},{title:"Cron",slotName:"cron",width:240},{title:"Last run time",dataIndex:"run_time",slotName:"time",width:140},{title:"Next run time",dataIndex:"next_run_time",slotName:"time",width:140},{title:"Run duration",slotName:"runDuration",width:140},{title:"Run count",dataIndex:"run_count",slotName:"runCount",width:140},{title:"Run error",dataIndex:"run_error"}],Ee={class:"h-full flex items-center gap-1"},De={style:{width:"120px"}},ze={key:1,class:"text-xs text-gray-500",style:{padding:"0 13px","line-height":"24px"}},Se={style:{color:"rgb(var(--arcoblue-6))"}},Le={__name:"Cron",props:{record:Object},setup(d){const E=Z("visibleCronExpExample"),{run:D,loading:x}=R(se,{manual:!0,onSuccess:m=>{m.success&&F.success(C("message.success",[C("start")]))}}),{run:b,loading:h}=R(re,{manual:!0,onSuccess:m=>{m.success&&F.success(C("message.success",[C("stop")]))}}),{run:y}=R(ue,{manual:!0,onSuccess:(m,i)=>{!m.success||(F.success(C("message.success",[C("update")])),i[2].editCronExp=!1)}});function z(m){m.cron_start?D(m.id):b(m.id)}return(m,i)=>{const O=n("a-switch"),M=n("icon-question-circle"),U=n("a-input"),B=n("icon-edit"),j=n("icon-save"),r=n("icon-minus-circle");return l(),g("div",Ee,[t(O,{disabled:!d.record.cron_enable,size:"mini",modelValue:d.record.cron_start,"onUpdate:modelValue":i[0]||(i[0]=s=>d.record.cron_start=s),onChange:i[1]||(i[1]=s=>z(d.record)),loading:a(x)||a(h)},null,8,["disabled","modelValue","loading"]),d.record.cron_enable?(l(),g($,{key:0},[L("div",De,[d.record.editCronExp?(l(),f(U,{key:0,size:"mini",modelValue:d.record.cron_exp,"onUpdate:modelValue":i[3]||(i[3]=s=>d.record.cron_exp=s),class:fe({readOnly:!d.record.editCronExp}),style:{"padding-right":"6px"}},{suffix:e(()=>[t(M,{onClick:i[2]||(i[2]=s=>E.value=!0),class:"cursor-pointer"})]),_:1},8,["modelValue","class"])):(l(),g("span",ze,c(d.record.cron_exp),1))]),L("div",Se,[d.record.editCronExp?(l(),g($,{key:1},[t(j,{onClick:i[5]||(i[5]=s=>a(y)(d.record.id,d.record.cron_exp,d.record)),class:"cursor-pointer opacity-80 hover:opacity-100 mr-1"}),t(r,{onClick:i[6]||(i[6]=s=>d.record.editCronExp=!1),class:"cursor-pointer opacity-80 hover:opacity-100 mr-1"})],64)):(l(),f(B,{key:0,onClick:i[4]||(i[4]=s=>d.record.editCronExp=!0),class:"cursor-pointer opacity-80 hover:opacity-100"}))])],64)):te("",!0)])}}},Oe={class:"text-sm text-gray-500"},Ne=L("th",{style:{color:"var(--color-text-1)","background-color":"var(--color-fill-2)"}},null,-1),Ve=L("td",{style:{color:"var(--color-text-1)"}},null,-1),Re={class:"flex items-center"},Me={key:0},Be={class:"font-mono text-gray-500 whitespace-pre"},Ue={__name:"Log",setup(d){const E=Z("currentID"),D=Z("visibleLog"),x=w(100),b=le(()=>"calc(90vh - 30px)"),h=w(!1),y=w({}),z=[{width:30,slotName:"detail"},{title:"time",dataIndex:"time",slotName:"time",width:120},{title:"level",dataIndex:"level",slotName:"level",width:100},{title:"file",dataIndex:"file",ellipsis:!0,width:300},{title:"message",dataIndex:"msg",ellipsis:!0,width:300},{title:"more",dataIndex:"more",slotName:"more"}];async function m(r){const s=r!=null&&r.page?r.page+1:1,k=await ce(E.value,{page:s,limit:x.value});return{list:j(k),page:s}}const{loading:i,loadingMore:O,dataList:M,loadMore:U,refresh:B}=xe(m,{});function j(r){r=r.reverse();for(let s in r){let k=de(r[s]);delete k.level,delete k.time,delete k.file,delete k.msg,r[s].more=k}return r}return(r,s)=>{const k=n("a-input-number"),q=n("a-button"),G=n("a-space"),H=n("icon-eye"),p=n("a-link"),_=n("a-tag"),K=n("a-table"),P=n("a-card"),N=n("a-descriptions-item"),A=n("a-descriptions"),W=n("a-modal");return l(),g($,null,[t(P,{class:"w-full h-full",size:"small",bordered:!1,"body-style":{padding:"0"},"header-style":{border:"none",padding:"8px 0"}},{title:e(()=>[v(c(r.$t("logs"))+" ",1),L("span",Oe,c(r.$t(a(E))),1)]),extra:e(()=>[t(G,null,{default:e(()=>[t(k,{size:"small",modelValue:x.value,"onUpdate:modelValue":s[0]||(s[0]=u=>x.value=u),style:{width:"80px"},min:1,onKeyup:ye(a(B),["enter"])},null,8,["modelValue","onKeyup"]),t(q,{size:"small",onClick:a(B),type:"outline"},{default:e(()=>[v(c(r.$t("refresh")),1)]),_:1},8,["onClick"]),t(q,{size:"small",onClick:a(U),type:"outline"},{default:e(()=>[v(c(r.$t("more")),1)]),_:1},8,["onClick"]),t(q,{size:"small",onClick:s[1]||(s[1]=u=>D.value=!1),type:"outline"},{default:e(()=>[v(c(r.$t("close")),1)]),_:1})]),_:1})]),default:e(()=>[t(K,{size:"mini",columns:z,data:a(M),pagination:!1,scroll:{y:a(b)},"virtual-list-props":a(M).length>1?{height:a(b),buffer:30}:void 0,loading:a(i)||a(O),style:{"--border-radius-medium":"0"}},{th:e(()=>[Ne]),td:e(()=>[Ve]),detail:e(({record:u,rowIndex:I,column:V})=>[L("div",Re,[t(p,{onClick:oe=>{h.value=!0,y.value=u}},{default:e(()=>[t(H,{style:{color:"#6b7f94"}})]),_:2},1032,["onClick"])])]),time:e(({record:u,rowIndex:I,column:V})=>[t(a(ee),{time:u.time,to:Date.now(),type:"relative"},null,8,["time","to"])]),more:e(({record:u,rowIndex:I,column:V})=>[Object.keys(u[V.dataIndex]).length>0?(l(),g("div",Me,c(JSON.stringify(u[V.dataIndex]).substring(0,130)),1)):te("",!0)]),level:e(({record:u,rowIndex:I,column:V})=>[u.level==="info"?(l(),f(_,{key:0,size:"mini",color:"blue"},{default:e(()=>[v(c(u.level),1)]),_:2},1024)):u.level==="debug"?(l(),f(_,{key:1,size:"mini",color:"cyan"},{default:e(()=>[v(c(u.level),1)]),_:2},1024)):(l(),f(_,{key:2,size:"mini",color:"red"},{default:e(()=>[v(c(u.level),1)]),_:2},1024))]),_:1},8,["data","scroll","virtual-list-props","loading"])]),_:1}),t(W,{visible:h.value,"onUpdate:visible":s[2]||(s[2]=u=>h.value=u),title:"Log detail","title-align":"start","modal-style":{width:"auto",height:"92%",minWidth:"600px",maxWidth:"80%"},"body-style":{height:"calc(100% - 52px)"},footer:!1},{default:e(()=>[t(A,{column:1,bordered:""},{default:e(()=>[t(N,{label:"time"},{default:e(()=>[t(a(ee),{time:y.value.time},null,8,["time"])]),_:1}),t(N,{label:"level"},{default:e(()=>[v(c(y.value.level),1)]),_:1}),t(N,{label:"file"},{default:e(()=>[v(c(y.value.file),1)]),_:1}),t(N,{label:"msg"},{default:e(()=>[v(c(y.value.msg),1)]),_:1}),(l(!0),g($,null,X(y.value.more,(u,I)=>(l(),f(N,{label:I},{default:e(()=>[L("code",Be,c(u),1)]),_:2},1032,["label"]))),256))]),_:1})]),_:1},8,["visible","body-style"])],64)}}};const je={key:1},Ae={key:1},Te={key:0},Fe={key:1},wt={__name:"index",setup(d){const E=me(),D=w(!1),x=w(""),b=w({}),h=be(),y=Object.assign({"./options/DetectLinks.vue":()=>Q(()=>import("./DetectLinks.c1cb0221.js"),["assets/DetectLinks.c1cb0221.js","assets/index.ad236f72.js","assets/@vue.1832462a.js","assets/vue-router.d0ac2f3e.js","assets/vue-i18n.32b246c6.js","assets/@intlify.bed9fa1a.js","assets/source-map.205bdfab.js","assets/vue.307b73bb.js","assets/@arco-design.fc217e7a.js","assets/resize-observer-polyfill.8deb1e21.js","assets/compute-scroll-into-view.17358474.js","assets/b-tween.87ffe365.js","assets/dayjs.396bdce9.js","assets/b-validate.ee581f7d.js","assets/number-precision.6dad9ff9.js","assets/scroll-into-view-if-needed.61c672a4.js","assets/@arco-design.3d3a5979.css","assets/@vueuse.b7caaad8.js","assets/pinia.3d582541.js","assets/vue-demi.b3a9cad9.js","assets/naive-ui.4ada00fb.js","assets/date-fns.a06005bd.js","assets/seemly.d0f7d7a4.js","assets/evtd.9eee5233.js","assets/@css-render.fee374bc.js","assets/css-render.20ab466e.js","assets/@emotion.6322e2ae.js","assets/vooks.186fd3b0.js","assets/vueuc.533174bc.js","assets/vdirs.ab69c576.js","assets/@juggle.32c34d6c.js","assets/lodash-es.33d1f95f.js","assets/date-fns-tz.c3c7eb03.js","assets/axios.7d4390ff.js","assets/form-data.2b153385.js","assets/vue-request.068b6d0d.js","assets/index.fbce9a41.css","assets/tailwindcss.8b9636b9.css","assets/DetectLinks.2709cabd.css"]),"./options/GenerateSlug.vue":()=>Q(()=>import("./GenerateSlug.628bcabe.js"),["assets/GenerateSlug.628bcabe.js","assets/@vue.1832462a.js"]),"./options/SaveArticleImages.vue":()=>Q(()=>import("./SaveArticleImages.8ac998e0.js"),["assets/SaveArticleImages.8ac998e0.js","assets/index.ad236f72.js","assets/@vue.1832462a.js","assets/vue-router.d0ac2f3e.js","assets/vue-i18n.32b246c6.js","assets/@intlify.bed9fa1a.js","assets/source-map.205bdfab.js","assets/vue.307b73bb.js","assets/@arco-design.fc217e7a.js","assets/resize-observer-polyfill.8deb1e21.js","assets/compute-scroll-into-view.17358474.js","assets/b-tween.87ffe365.js","assets/dayjs.396bdce9.js","assets/b-validate.ee581f7d.js","assets/number-precision.6dad9ff9.js","assets/scroll-into-view-if-needed.61c672a4.js","assets/@arco-design.3d3a5979.css","assets/@vueuse.b7caaad8.js","assets/pinia.3d582541.js","assets/vue-demi.b3a9cad9.js","assets/naive-ui.4ada00fb.js","assets/date-fns.a06005bd.js","assets/seemly.d0f7d7a4.js","assets/evtd.9eee5233.js","assets/@css-render.fee374bc.js","assets/css-render.20ab466e.js","assets/@emotion.6322e2ae.js","assets/vooks.186fd3b0.js","assets/vueuc.533174bc.js","assets/vdirs.ab69c576.js","assets/@juggle.32c34d6c.js","assets/lodash-es.33d1f95f.js","assets/date-fns-tz.c3c7eb03.js","assets/axios.7d4390ff.js","assets/form-data.2b153385.js","assets/vue-request.068b6d0d.js","assets/index.fbce9a41.css","assets/tailwindcss.8b9636b9.css","assets/SaveArticleImages.45e6e1fa.css"])}),z=w([]),m=w(!1),i=w(!1),O=le(()=>{if(!!x.value)return C(x.value)});Y("currentID",x),Y("options",b),Y("visibleCronExpExample",m),Y("visibleLog",i);const{loading:M}=R(pe,{onSuccess:p=>{z.value=p}}),{run:U,loading:B}=R(_e,{manual:!0,onSuccess:(p,[_])=>{b.value=p,D.value=!0,h.value=Ce(y["./options/"+_+".vue"])}}),{run:j,loading:r}=R(ve,{manual:!0,onSuccess:p=>{p.success&&F.success(C("message.success",[C("save")]))}}),s=w({}),{run:k,loading:q}=R(ge,{manual:!0,onBefore:([p])=>{s.value[p]=!0},onSuccess:(p,[_])=>{s.value[_]=!1,p.success&&F.success(C("message.success",[C("run")]))}});function G(p){x.value=p.id,U(p.id)}function H(p){x.value=p.id,i.value=!0}return(p,_)=>{const K=n("icon-info-circle"),P=n("a-tooltip"),N=n("icon-bookmark"),A=n("a-button"),W=n("icon-settings"),u=n("icon-play-circle"),I=n("a-tag"),V=n("a-table"),oe=n("a-form"),ae=n("a-spin"),J=n("a-modal");return l(),g($,null,[t(V,{columns:a($e),data:z.value,loading:a(M),pagination:!1},{id:e(({record:o,rowIndex:T,column:S})=>[o.about?(l(),f(P,{key:0},{content:e(()=>[v(c(o.about),1)]),default:e(()=>[t(K,{class:"ml-2 opacity-60"})]),_:2},1024)):te("",!0),v(" "+c(p.$t(o.id)),1)]),action:e(({record:o,rowIndex:T,column:S})=>[t(A,{disabled:o.hide_logs,size:"small",type:"text",onClick:ne=>H(o)},{icon:e(()=>[t(N,{size:18})]),_:2},1032,["disabled","onClick"]),t(A,{disabled:o.no_options,size:"small",type:"text",onClick:ne=>G(o)},{icon:e(()=>[t(W,{size:18})]),_:2},1032,["disabled","onClick"]),t(A,{disabled:!o.run_enable,size:"small",type:"text",onClick:ne=>a(k)(o.id),loading:s.value[o.id]},{icon:e(()=>[t(u,{size:18})]),_:2},1032,["disabled","onClick","loading"])]),cron:e(({record:o,rowIndex:T,column:S})=>[t(Le,{record:o},null,8,["record"])]),time:e(({record:o,rowIndex:T,column:S})=>[o.run_enable&&o[S.dataIndex]>0?(l(),f(P,{key:0,content:a(he)(o[S.dataIndex]*1e3,"YYYY-MM-DD HH:mm:ss").value},{default:e(()=>[t(a(ee),{time:o[S.dataIndex]*1e3,to:Date.now(),type:"relative"},null,8,["time","to"])]),_:2},1032,["content"])):(l(),g("span",je," - "))]),runDuration:e(({record:o,rowIndex:T,column:S})=>[o.run_enable?(l(),g($,{key:0},[o.run_duration>500?(l(),f(I,{key:0,color:"purple"},{default:e(()=>[v(c(o.run_duration)+" ms",1)]),_:2},1024)):o.run_duration>100?(l(),f(I,{key:1,color:"orangered"},{default:e(()=>[v(c(o.run_duration)+" ms",1)]),_:2},1024)):(l(),f(I,{key:2,color:"green"},{default:e(()=>[v(c(o.run_duration)+" ms",1)]),_:2},1024))],64)):(l(),g("span",Ae," - "))]),runCount:e(({record:o,rowIndex:T,column:S})=>[o.run_enable?(l(),g("span",Te,c(o.run_count),1)):(l(),g("span",Fe," - "))]),_:1},8,["columns","data","loading"]),t(J,{visible:D.value,"onUpdate:visible":_[0]||(_[0]=o=>D.value=o),title:a(O),"title-align":"start",onOk:_[1]||(_[1]=o=>a(j)(x.value,b.value)),"ok-loading":a(r)},{default:e(()=>[t(ae,{loading:a(B),class:"w-full"},{default:e(()=>[t(oe,{model:b.value,"auto-label-width":"",layout:a(E).isMobile?"vertical":"horizontal"},{default:e(()=>[(l(),f(ke(a(h))))]),_:1},8,["model","layout"])]),_:1},8,["loading"])]),_:1},8,["visible","title","ok-loading"]),t(J,{visible:m.value,"onUpdate:visible":_[2]||(_[2]=o=>m.value=o),title:"Example",width:600,simple:"",footer:!1},{default:e(()=>[t(Ie)]),_:1},8,["visible"]),t(J,{visible:i.value,"onUpdate:visible":_[3]||(_[3]=o=>i.value=o),width:"96%","modal-style":{height:"96%"},simple:"",footer:!1,"modal-class":"logModal","unmount-on-close":""},{default:e(()=>[t(Ue)]),_:1},8,["visible"])],64)}}};export{wt as default};
